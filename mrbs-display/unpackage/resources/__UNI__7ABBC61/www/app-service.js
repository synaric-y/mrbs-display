if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((n=>t.resolve(e()).then((()=>n))),(n=>t.resolve(e()).then((()=>{throw n}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...n){uni.__log__?uni.__log__(e,t,...n):console[e].apply(console,[...n,t])}__definePage("pages/index/index",((e,t)=>{const n=e.__vccOpts||e;for(const[o,i]of t)n[o]=i;return n})({data:()=>({lineStartTime:8,lineEndTime:21,spanList:[],timelineInterval:1800,timelineColorList:[],syncData:{},foundNextEntry:{},showSetting:!1,_roomId:2,roomId:2}),onLoad(){let e=uni.getStorageSync("ROOM_ID");e&&(this.roomId=Number(e),this._roomId=Number(e)),this.syncRoom(),setInterval((()=>{this.syncRoom()}),5e3)},methods:{onSetting(){this.showSetting=!0},onSetRoomId(){t("log","at pages/index/index.vue:104","set room",this._roomId),isNaN(this._roomId)?uni.showToast({title:"请填写正确的内置码"}):(this.roomId=this._roomId,this.showSetting=!1,uni.setStorageSync("ROOM_ID",this.roomId))},syncRoom(){uni.request({url:"http://172.16.89.91/web/appapi/api.php?act=sync_room",method:"POST",header:{"Content-type":"application/x-www-form-urlencoded","Accept-Language":"zh-CN,zh;q=0.9"},data:{room_id:this.roomId},success:e=>{let n=e.data.data;if(t("log","at pages/index/index.vue:129","返回数据",n),n.now_ap=n.now_time.slice(-2),n.now_time=n.now_time.slice(0,-2),n.entries)for(let t of n.entries)t.start_end=this.formatTime(t.start_time)+"-"+this.formatTime(t.end_time);n.now_entry&&(n.now_entry.start_end=this.formatTime(n.now_entry.start_time)+"-"+this.formatTime(n.now_entry.end_time)),this.initTimeLine(n)},fail:e=>{t("error","at pages/index/index.vue:145",e)}})},initTimeLine(e){let n=this.lineStartTime,o=[],i=!0;for(;n<=this.lineEndTime;){i||o.push({text:"·",type:1});let e=n.toString().padStart(2,"0")+":00";o.push({text:e,type:0}),i=!1,n+=1}this.spanList=o;let r=!1,a=e.entries,l=(new Date).getTime()/1e3;for(let t of a)if(l<t.start_time){r=t;break}r&&(this.foundNextEntry=r);let s=this.getTimestampOfTodayStart(),c=[],m=676,d=60*(this.lineEndTime-this.lineStartTime+1)*60;n=60*this.lineStartTime*60+s;let p=0;for(;n<=60*(this.lineEndTime+1)*60+s;){let o=!1;for(let i of a)if(n>=i.start_time&&n<=i.end_time){if(0!=p){(n-p)/d*m>0&&(n>l?(t("log","at pages/index/index.vue:203","case 1"),c.push({text:this.hideTimelineText(n-p,"可预订"),textColor:"white",bg:"#08D50A",width:(n-p)/d*m})):(t("log","at pages/index/index.vue:211","case 2"),c.push({text:"",textColor:"black",bg:"#9A9A9A",width:(n-p)/d*m}))),p=0}let r="已预定",a="#FF0000",s="white";l>=i.start_time&&l<=i.end_time?(r="会议中",a="#FFFF00",s="black",e.current=i):l>i.end_time&&(r="已结束",a="#585757",s="white"),c.push({text:this.hideTimelineText(i.end_time-i.start_time,r),bg:a,name:i.name,textColor:s,width:(i.end_time-i.start_time)/d*m}),o=!0,n=i.end_time,p=i.end_time;break}o?a.shift():(0==p?p=n:p<l&&n<l&&n+this.timelineInterval>l&&(c.push({text:"",textColor:"black",bg:"#9A9A9A",width:(n-p)/d*m}),p=0),n+=this.timelineInterval)}0!=p&&(n<l?c.push({text:"",textColor:"black",bg:"#9A9A9A",width:(n-p)/d*m}):c.push({text:this.hideTimelineText(n-p-this.timelineInterval,"可预订"),bg:"#08D50A",textColor:"white",width:(n-p-this.timelineInterval)/d*m})),t("log","at pages/index/index.vue:288",c),this.timelineColorList=c,this.syncData=e},getTimestampOfTodayStart(){let e=new Date;return e.setHours(0,0,0,0),e.getTime()/1e3},hideTimelineText(e,t){return e<=this.timelineInterval?"":t},formatTime(e){var t=new Date(1e3*e);return t.getHours().toString().padStart(2,"0")+":"+t.getMinutes().toString().padStart(2,"0")}}},[["render",function(t,n,o,i,r,a){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("image",{class:"bg",src:"/static/home_bg.png"}),e.createElementVNode("view",{class:"container-inner"},[e.createElementVNode("text",{class:"now-time"},[e.createTextVNode(e.toDisplayString(r.syncData.now_time)+" ",1),e.createElementVNode("text",{class:"now-time-tail"},e.toDisplayString(r.syncData.now_ap),1)]),e.createElementVNode("text",{class:"now-date"},e.toDisplayString(r.syncData.display_day),1),e.createElementVNode("view",{class:"divider-one"}),r.syncData.room?(e.openBlock(),e.createElementBlock("image",{key:0,class:"room-icon",src:r.syncData.room.icon},null,8,["src"])):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"room-tail",onLongpress:n[0]||(n[0]=(...e)=>a.onSetting&&a.onSetting(...e))},"会议室",32),r.syncData&&r.syncData.current?(e.openBlock(),e.createElementBlock("view",{key:1,class:"content-container"},[e.createElementVNode("view",{class:"room-space"}),e.createElementVNode("view",{class:"room-content-container"},[e.createElementVNode("text",{class:"room-name"},[e.createTextVNode("会议主题："),e.createElementVNode("text",{style:{"font-size":"26rpx"}},e.toDisplayString(r.syncData.current.name),1)]),e.createElementVNode("text",{class:"room-entry-duration"},e.toDisplayString(r.syncData.current.start_end),1),e.createElementVNode("text",{class:"room-booker"},"预定人："+e.toDisplayString(r.syncData.current.book_by),1)]),e.createElementVNode("view",{class:"room-status room-status-using"},"会 议 中")])):r.foundNextEntry?(e.openBlock(),e.createElementBlock("view",{key:2,class:"content-container"},[e.createElementVNode("view",{class:"room-space"}),e.createElementVNode("view",{class:"room-status room-status-idle"},"空 闲 中"),r.foundNextEntry&&r.foundNextEntry.name?(e.openBlock(),e.createElementBlock("view",{key:0,class:"room-content-container"},[e.createElementVNode("text",{class:"room-name"},[e.createTextVNode("即将开始："),e.createElementVNode("text",{style:{"font-size":"26rpx"}},e.toDisplayString(r.foundNextEntry.name),1)]),e.createElementVNode("text",{class:"room-entry-duration"},e.toDisplayString(r.foundNextEntry.start_end),1),e.createElementVNode("text",{class:"room-booker"},"预定人："+e.toDisplayString(r.foundNextEntry.book_by),1)])):e.createCommentVNode("",!0)])):(e.openBlock(),e.createElementBlock("view",{key:3,class:"content-container"})),e.createElementVNode("view",{class:"divider-two"}),e.createElementVNode("view",{class:"timeline-container"},[e.createElementVNode("view",{class:"time-span-container"},[e.createElementVNode("view",{style:{width:"7rpx"}}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.spanList,((t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass([0==t.type?"time-span-text":"time-span-dot"]),key:n},e.toDisplayString(t.text),3)))),128)),e.createElementVNode("view",{style:{width:"7rpx"}})]),e.createElementVNode("view",{class:"timeline-line-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.timelineColorList,((t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"timeline-line-item",key:n,style:e.normalizeStyle({background:t.bg,width:t.width+"rpx",height:"100%",color:t.textColor})},e.toDisplayString(t.text),5)))),128))]),e.createElementVNode("view",{class:"timeline-line-container",style:{"margin-top":"5rpx"}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.timelineColorList,((t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"timeline-line-entry",style:e.normalizeStyle({width:t.width+"rpx",height:"100%"}),key:n},[e.createElementVNode("text",{class:"timeline-line-item tl-item-ec"},e.toDisplayString(t.name),1)],4)))),128))]),e.createElementVNode("view",{class:"logo-container"},[e.createElementVNode("image",{class:"logo",src:"/static/logo.png"})])])]),r.showSetting?(e.openBlock(),e.createElementBlock("view",{key:0,class:"popup-setting"},[e.withDirectives(e.createElementVNode("input",{class:"popup-input","onUpdate:modelValue":n[1]||(n[1]=e=>r._roomId=e),placeholder:"请输入内置码"},null,512),[[e.vModelText,r._roomId]]),e.createElementVNode("view",{onClick:n[2]||(n[2]=(...e)=>a.onSetRoomId&&a.onSetRoomId(...e))},"确定")])):e.createCommentVNode("",!0)])}]]));const n={onLaunch:function(){t("log","at App.vue:4","App Launch"),plus.screen.lockOrientation("landscape-primary"),plus.navigator.setFullscreen(!0);var e=plus.android.runtimeMainActivity(),n=plus.android.invoke(e,"getWindow");plus.android.invoke(n,"setNavigationBarColor",0);var o=plus.android.invoke(n,"getDecorView");plus.android.invoke(o,"setSystemUiVisibility",1792)},onShow:function(){t("log","at App.vue:23","App Show")},onHide:function(){t("log","at App.vue:26","App Hide")}};const{app:o,Vuex:i,Pinia:r}={app:e.createVueApp(n)};uni.Vuex=i,uni.Pinia=r,o.provide("__globalStyles",__uniConfig.styles),o._component.mpType="app",o._component.render=()=>{},o.mount("#app")}(Vue);
